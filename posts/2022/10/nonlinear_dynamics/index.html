<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>the phase portrait of a nonlinear pendulum | Subhodeep Sarkar</title> <meta name="author" content="Subhodeep Sarkar"/> <meta name="description" content=""/> <meta name="keywords" content="physics, theoretical-physics, academic-website, black-holes, general-relativity, gravity, books, literature"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light"/> <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>⚛️</text></svg>"> <link rel="stylesheet" href="/al-folio/assets/css/main.css"> <link rel="canonical" href="https://subhodeeps.github.io/al-folio/posts/2022/10/nonlinear_dynamics/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"/> <script src="/al-folio/assets/js/theme.js"></script> <script src="/al-folio/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/al-folio/"><span class="font-weight-bold">Subhodeep </span>Sarkar</a> <div class="navbar-brand social"> <a href="mailto:%73%75%62%68%6F%64%65%65%70.%73%61%72%6B%61%72%31@%67%6D%61%69%6C.%63%6F%6D" title="email"><i class="fas fa-envelope"></i></a> <a href="https://scholar.google.com/citations?user=WpYbE3oAAAAJ" title="Google Scholar" target="_blank" rel="noopener noreferrer"><i class="ai ai-google-scholar"></i></a> <a href="https://www.semanticscholar.org/author/9729924" title="Semantic Scholar" target="_blank" rel="noopener noreferrer"><i class="ai ai-semantic-scholar"></i></a> </div> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/al-folio/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/al-folio/cv/">cv</a> </li> <li class="nav-item "> <a class="nav-link" href="/al-folio/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/al-folio/teaching/">teaching</a> </li> <li class="nav-item "> <a class="nav-link" href="/al-folio/_pages/books/">bookshelf</a> </li> <li class="nav-item "> <a class="nav-link" href="/al-folio/blog/">blog</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">the phase portrait of a nonlinear pendulum</h1> <p class="post-meta">October 2, 2022</p> <p class="post-tags"> <a href="/al-folio/blog/2022"> <i class="fas fa-calendar fa-sm"></i> 2022 </a>   ·   <a href="/al-folio/blog/tag/nonlinear%20dynamics"> <i class="fas fa-hashtag fa-sm"></i> nonlinear dynamics</a>   <a href="/al-folio/blog/tag/phase%20portrait"> <i class="fas fa-hashtag fa-sm"></i> phase portrait</a>   <a href="/al-folio/blog/tag/classical%20mechanics"> <i class="fas fa-hashtag fa-sm"></i> classical mechanics</a>   </p> </header> <article class="post-content"> <p>The motion of a nonlinear pendulum is governed by the well known equation,</p> \[\begin{align} \dfrac{d^2 x}{d t^2} + \sin x = 0 . \end{align}\] <p>The above equation is an example of a second-order, nonlinear ordinary differential equation (ODE). We can now introduce the following coordinate,</p> \[\begin{align} y &amp; = \dfrac{d x}{d t}, \end{align}\] <p>and converted the second order ODE into a system to two first order ODEs, viz.,</p> \[\begin{align} \dot{x} &amp; = y, \\ \dot{y} &amp; = - \sin x. \end{align}\] <p>Here, dot denotes a derivative with respect to time.</p> <p>We can now introduce a vector \(\vec{S} = x \hat{i} + y \hat{j},\)</p> <p>and write our $2D$ system as,</p> \[\begin{align} \dfrac{d \vec{S}}{d t} = \begin{bmatrix} S_2 \\ -\sin S_1 \end{bmatrix}= \begin{bmatrix} y \\ -\sin x \end{bmatrix}, \end{align}\] <p>where $S_i$ is the $i$-th component of $\vec{S}$.</p> <p>Our task is to analyse the behaviour of this system, and we do that by</p> <ul> <li>drawing the phase portrait of the system,</li> <li>solving the system of ODEs numerically.</li> </ul> <p>We shall use python to perfrom the above tasks. We begin by importing suitable python libraries,</p> <ul> <li> <code class="language-plaintext highlighter-rouge">numpy</code> to perform manipulations over numeric arrays</li> <li> <code class="language-plaintext highlighter-rouge">scipy.integrate.odeint</code> to numerically solve our ODEs</li> <li> <code class="language-plaintext highlighter-rouge">matplotlib</code> to plot the results</li> <li> <code class="language-plaintext highlighter-rouge">seaborn</code> to make the graphs look pretty.</li> </ul> <figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td> <td class="code"><pre><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="n">scipy.integrate</span> <span class="kn">import</span> <span class="n">odeint</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="n">seaborn</span> <span class="k">as</span> <span class="n">sns</span>
<span class="n">sns</span><span class="p">.</span><span class="nf">set_style</span><span class="p">(</span><span class="s">"darkgrid"</span><span class="p">)</span>
</pre></td> </tr></tbody></table></code></pre></figure> <p>Our first task is to code up a function that returns the right hand side (RHS) of the system.</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
</pre></td> <td class="code"><pre><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">S</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="p">.</span><span class="nf">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
</pre></td> </tr></tbody></table></code></pre></figure> <p>Notice that</p> <ul> <li>our function takes two arguments $S$ and $t$.</li> <li>although our system is autonomous (that is, the RHS is independent of time), we still include the independent variable, this is because our ODE solvers are designed to accept functions which depend on both the variables. <ul> <li>the order of the arguments in the function signature is important, <code class="language-plaintext highlighter-rouge">odeint</code> expects the independent variable first.</li> <li>moreover, we set $t$ to take a default value $(0)$, so that can avoid passing a superficial argument while plotting the functions; we keep the $t$ to ensure we can use the same function for numerically solving the ODEs and for plotting the phase portrait.</li> <li> <strong>note</strong> a better approach would be to use <code class="language-plaintext highlighter-rouge">solve_ivp</code>.</li> </ul> </li> </ul> <p>Our first order of business is to generate the phase portrait: we have to essentially sketch the vector field \(\begin{align} \dot{\vec{S}} &amp; = \dot{x} ~ \hat{i} ~ + ~ \dot{y} ~ \hat{j},\\ &amp; = y ~ \hat{i} ~ - ~ \sin x \hat{j}. \end{align}\)</p> <p>To plot a vector field, we need the following two functions:</p> <ul> <li> <code class="language-plaintext highlighter-rouge">numpy.meshgrid</code> to generate a grid of points (over the 2D plane) where we must calculate the value of the components of the vector field.</li> <li> <code class="language-plaintext highlighter-rouge">matplotlib.pyplt.streamplot</code> to visualize a vector field by plotting the streamlines of the vector flow.</li> </ul> <figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td> <td class="code"><pre><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="o">-</span><span class="mf">4.0</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="p">,</span> <span class="mf">4.0</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">pi</span>
<span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">3.0</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>

<span class="n">XX</span> <span class="p">,</span> <span class="n">YY</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">xdot</span><span class="p">,</span> <span class="n">ydot</span> <span class="o">=</span> <span class="nf">f</span><span class="p">([</span><span class="n">XX</span><span class="p">,</span> <span class="n">YY</span><span class="p">])</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">streamplot</span><span class="p">(</span><span class="n">XX</span><span class="p">,</span> <span class="n">YY</span><span class="p">,</span> <span class="n">xdot</span><span class="p">,</span> <span class="n">ydot</span><span class="p">,</span> <span class="n">density</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</pre></td> </tr></tbody></table></code></pre></figure> <p><img src="/assets/nonlinearpendulum/output_6_0.png" alt="png"></p> <p>In the above code block, we,</p> <ul> <li>first set up the figure and axes object (if this looks unfamiliar, <a href="https://stackoverflow.com/a/34162641" target="_blank" rel="noopener noreferrer">check this out</a> </li> <li>we then set appropriate ranges for the variables, $x$ and $y$.</li> <li>we use <code class="language-plaintext highlighter-rouge">numpy.linspace</code> to generate 30 points along the $x$ and $y$ axes each.</li> <li>we then use <code class="language-plaintext highlighter-rouge">numpy.meshgrid</code> to obtain two 2D arrays $XX$ and $YY$ that helps us in computing the vector field over the entire $x-y$ plane.</li> <li>we store the values of the components of the vector field in <code class="language-plaintext highlighter-rouge">xdot</code> and <code class="language-plaintext highlighter-rouge">ydot</code>.</li> <li>finally we use <code class="language-plaintext highlighter-rouge">matplotlib.pyplot.streamplot</code> to sketch the vector field.</li> </ul> <p>The primary purpose of using <code class="language-plaintext highlighter-rouge">meshgrid</code> is to avoid using slow python loops. To get a better understanding of how <code class="language-plaintext highlighter-rouge">meshgrid</code> works, <a href="https://stackoverflow.com/questions/36013063/what-is-the-purpose-of-meshgrid-in-python-numpy" target="_blank" rel="noopener noreferrer">check this out</a>.</p> <p>Notice the line where <code class="language-plaintext highlighter-rouge">streamplot</code> is invoked. The basic syntax is:</p> <p><code class="language-plaintext highlighter-rouge">ax.streamplot(x_grid,y_grid,x_vec,y_vec, density=spacing)</code></p> <p>Here <code class="language-plaintext highlighter-rouge">x_grid</code> and <code class="language-plaintext highlighter-rouge">y_grid</code> are arrays of <code class="language-plaintext highlighter-rouge">x</code>, <code class="language-plaintext highlighter-rouge">y</code> points. The arrays <code class="language-plaintext highlighter-rouge">x_vec</code> and <code class="language-plaintext highlighter-rouge">y_vec</code> denote the stream velocity at each point on the grid. The keyword argument <code class="language-plaintext highlighter-rouge">density=spacing</code> specifies how close the streamlines are drawn together.</p> <p>We shall now use <code class="language-plaintext highlighter-rouge">odeint</code> to numerically solve the $2D$ system.</p> <p>Since, we have two differntial equations, we have to provide two initial conditions. First, shall try to simulate the case where the bob of the pendulum is initially at rest, and it is set into motion with some initial velocity, that is,</p> <p>\(x(0) = 0, ~ y(0) = c,\) where $c$ is a constant.</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td> <td class="code"><pre><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="n">t0</span><span class="p">,</span> <span class="n">tf</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">45.0</span>
<span class="n">tspan</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">tf</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="n">x0</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="k">for</span> <span class="n">y0</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span>
    <span class="n">S0</span> <span class="o">=</span> <span class="p">[</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">]</span>
    <span class="n">ys</span> <span class="o">=</span> <span class="nf">odeint</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">S0</span><span class="p">,</span> <span class="n">tspan</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">ys</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="p">,</span> <span class="n">ys</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s">'r-'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</pre></td> </tr></tbody></table></code></pre></figure> <p><img src="/assets/nonlinearpendulum/output_9_0.png" alt="png"></p> <p>In the above code block, we:</p> <ul> <li>first set up the figure and axes object</li> <li>set up the time interval over which we solve our ODEs</li> <li>provide the first initial condition, $x(0)=0$</li> <li>we then construct an array containing suitable values of $c$ which we shall use to provide the second initial condition</li> <li>we then run a loop that picks up one element after the other from the array containg $c$ and calls the ODE solver with the initial conditions $[0,c]$</li> <li>the solution is stored in ys and then plotted.</li> </ul> <p>We have used <code class="language-plaintext highlighter-rouge">odeint</code> to solve our ODEs; the syntax is <code class="language-plaintext highlighter-rouge">ys= odeint(model, initial_values, t)</code> where</p> <ul> <li> <code class="language-plaintext highlighter-rouge">model</code> is the RHS of the 2D system</li> <li> <code class="language-plaintext highlighter-rouge">initial values</code> is an array containing the initial conditions</li> <li> <code class="language-plaintext highlighter-rouge">t</code> is an array containing the point on the time axis where the ODEs are solved</li> </ul> <p><code class="language-plaintext highlighter-rouge">odeint</code> returns a matrix which has $k$ columns, one for each of the $k$ variables, and a row for each time point specified in <code class="language-plaintext highlighter-rouge">t</code>.</p> <p>Lastly, I will change some attributes of <code class="language-plaintext highlighter-rouge">seaborn</code> to change the colour of the plots and define a helper function to plot arrows along the trajectories on the phase space. The detailed working of this function is not important.</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
</pre></td> <td class="code"><pre><span class="c1">#define seaborn background colors
</span><span class="n">sns</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="n">rc</span><span class="o">=</span><span class="p">{</span><span class="s">'axes.facecolor'</span><span class="p">:</span> <span class="s">'#252a34'</span><span class="p">,</span><span class="s">'figure.facecolor'</span><span class="p">:</span><span class="s">'#252a34'</span><span class="p">})</span>
</pre></td> </tr></tbody></table></code></pre></figure> <figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td> <td class="code"><pre><span class="k">def</span> <span class="nf">plotarrows</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="nf">int</span><span class="p">((</span><span class="n">xs</span><span class="p">.</span><span class="n">size</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">xs</span> <span class="o">=</span> <span class="n">xs</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">s</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">:].</span><span class="nf">flatten</span><span class="p">()</span>
    <span class="n">ys</span> <span class="o">=</span> <span class="n">ys</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">s</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">:].</span><span class="nf">flatten</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xs</span><span class="p">.</span><span class="n">size</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">dx</span> <span class="o">=</span> <span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">dy</span> <span class="o">=</span> <span class="n">ys</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">ax</span><span class="p">.</span><span class="nf">arrow</span><span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ys</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span>
                  <span class="n">shape</span><span class="o">=</span><span class="s">'full'</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">length_includes_head</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">head_width</span><span class="o">=</span><span class="p">.</span><span class="mi">06</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'#ee5f5b'</span><span class="p">)</span>
</pre></td> </tr></tbody></table></code></pre></figure> <p>We now put everything togather.</p> <ul> <li>we sketch the vector field field (that is, draw the phase portrait)</li> <li>we solve the ODEs with the initial conditions <ul> <li>$x(0)= 5 \pi, y(0)= c ~ \mathrm{where} ~ c \in [-2, -1]$</li> <li>$x(0)= -5 \pi, y(0)= c ~ \mathrm{where} ~ c \in [1, 2]$</li> <li>$x(0)= 0 \pi, y(0)= c ~ \mathrm{where} ~ c \in (-2, 2)$</li> <li>and then plot everything</li> </ul> </li> </ul> <figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
</pre></td> <td class="code"><pre><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="o">-</span><span class="mf">4.0</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="p">,</span> <span class="mf">4.0</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">pi</span>
<span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">3.0</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>

<span class="n">XX</span> <span class="p">,</span> <span class="n">YY</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">xdot</span><span class="p">,</span> <span class="n">ydot</span> <span class="o">=</span> <span class="nf">f</span><span class="p">([</span><span class="n">XX</span><span class="p">,</span> <span class="n">YY</span><span class="p">])</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">streamplot</span><span class="p">(</span><span class="n">XX</span><span class="p">,</span> <span class="n">YY</span><span class="p">,</span> <span class="n">xdot</span><span class="p">,</span> <span class="n">ydot</span><span class="p">,</span> <span class="n">density</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'#52adc8'</span><span class="p">)</span>


<span class="n">t0</span><span class="p">,</span> <span class="n">tf</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">45.0</span>
<span class="n">tspan</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">tf</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="n">x0</span> <span class="o">=</span> <span class="mf">5.0</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">pi</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="k">for</span> <span class="n">y0</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span>
    <span class="n">S0</span> <span class="o">=</span> <span class="p">[</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">]</span>
    <span class="n">ys</span> <span class="o">=</span> <span class="nf">odeint</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">S0</span><span class="p">,</span> <span class="n">tspan</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">ys</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="p">,</span> <span class="n">ys</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s">'#ee5f5b'</span><span class="p">)</span>
    <span class="nf">plotarrows</span><span class="p">(</span><span class="n">ys</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">ys</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>

<span class="n">x0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">5.0</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">pi</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>



<span class="k">for</span> <span class="n">y0</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span>
    <span class="n">S0</span> <span class="o">=</span> <span class="p">[</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">]</span>
    <span class="n">ys</span> <span class="o">=</span> <span class="nf">odeint</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">S0</span><span class="p">,</span> <span class="n">tspan</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">ys</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="p">,</span> <span class="n">ys</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s">'#ee5f5b'</span><span class="p">)</span>
    <span class="nf">plotarrows</span><span class="p">(</span><span class="n">ys</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">ys</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>

<span class="n">x0</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.95</span><span class="p">,</span> <span class="mf">1.95</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">tspan</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">tf</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>

<span class="k">for</span> <span class="n">y0</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span>
    <span class="n">S0</span> <span class="o">=</span> <span class="p">[</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">]</span>
    <span class="n">ys</span> <span class="o">=</span> <span class="nf">odeint</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">S0</span><span class="p">,</span> <span class="n">tspan</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">ys</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="p">,</span> <span class="n">ys</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s">'#ee5f5b'</span><span class="p">)</span>
    <span class="nf">plotarrows</span><span class="p">(</span><span class="n">ys</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">ys</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>

<span class="n">ax</span><span class="p">.</span><span class="nf">set_xlim</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="nf">set_ylim</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)</span>

<span class="c1"># uncomment for grid lines but no labels
# ax.set(yticklabels=[]) # hide y labels
# ax.set(xticklabels=[]) # hide x labels
</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">axis</span><span class="p">(</span><span class="s">'off'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
<span class="n">fig</span><span class="p">.</span><span class="nf">savefig</span><span class="p">(</span><span class="s">"header.png"</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></td> </tr></tbody></table></code></pre></figure> <p><img src="/assets/nonlinearpendulum/output_15_0.png" alt="png"></p> <h3 id="references">References:</h3> <p>[1] Nonlinear Dynamics and Chaos, 2nd Ed by Steven Strogatz, CRC Press (2015).</p> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> <q>Perfection of character is this: to live each day as if it were your last, without frenzy, without apathy, without pretence.</q> ~ Marcus Aurelius | © Copyright 2023 Subhodeep Sarkar. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/al-folio/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/al-folio/assets/js/zoom.js"></script> <script defer src="/al-folio/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> </body> </html>